import matplotlib
import matplotlib.pyplot as plt
import numpy as np
import seaborn as sns
from matplotlib.collections import LineCollection

# sns.set_style('whitegrid')
# plt.style.use('seaborn')

palette = sns.color_palette('deep')
# font = {'family' : 'Times New Roman'}
# matplotlib.rc('font', **font)
# matplotlib.rc('text', usetex=False)

# rope1
grid_1 = [[-0.2 , 0.5549710005521774],
[-0.19 , 0.5372699081897736],
[-0.18000000000000002 , 0.5250302776694298],
[-0.17 , 0.5121219962835312],
[-0.16 , 0.5005134642124176],
[-0.15000000000000002 , 0.4922720044851303],
[-0.14 , 0.485567444562912],
[-0.13 , 0.48006928265094756],
[-0.12000000000000001 , 0.47547467350959777],
[-0.11000000000000001 , 0.47149972021579745],
[-0.1 , 0.467476961016655],
[-0.09000000000000001 , 0.46468711495399473],
[-0.08000000000000002 , 0.46159754544496534],
[-0.07 , 0.4582216203212738],
[-0.06 , 0.45472918450832367],
[-0.05000000000000002 , 0.45044266879558564],
[-0.04000000000000001 , 0.447932031750679],
[-0.03 , 0.4443345725536346],
[-0.020000000000000018 , 0.43951972424983976],
[-0.010000000000000009 , 0.43496220707893374],
[0.0 , 0.4310735434293747],
[0.009999999999999981 , 0.4271070659160614],
[0.01999999999999999 , 0.4244765967130661],
[0.03 , 0.4199046164751053],
[0.03999999999999998 , 0.4166211038827896],
[0.04999999999999999 , 0.41394186913967135],
[0.06 , 0.41149322092533114],
[0.07 , 0.40922273844480517],
[0.08000000000000002 , 0.4086087137460709],
[0.08999999999999997 , 0.4077616810798645],
[0.09999999999999998 , 0.4052093684673309],
[0.10999999999999999 , 0.4046826049685478],
[0.12 , 0.40282414853572845],
[0.13 , 0.40179487466812136],
[0.14 , 0.4010137811303139],
[0.15000000000000002 , 0.39832805246114733],
[0.15999999999999998 , 0.39815700352191924],
[0.16999999999999998 , 0.3978410139679909],
[0.18 , 0.3964655131101608],
[0.19 , 0.3955515086650848],
[0.2 , 0.3945047989487648],
[0.21000000000000002 , 0.3936335533857346],
[0.21999999999999997 , 0.39253424257040026],
[0.22999999999999998 , 0.39095523953437805],
[0.24 , 0.3894467905163765],
[0.25 , 0.38791398257017135],
[0.26 , 0.38707622736692426],
[0.27 , 0.386421200633049],
[0.27999999999999997 , 0.3861618027091026],
[0.29 , 0.38565886616706846],
[0.3 , 0.3851684287190437],
[0.31 , 0.384295916557312],
[0.32 , 0.38383544236421585],
[0.33 , 0.38313539028167726],
[0.34 , 0.38327134400606155],
[0.35000000000000003 , 0.382023549079895],
[0.36000000000000004 , 0.38180285692214966],
[0.37000000000000005 , 0.3810937851667404],
[0.37999999999999995 , 0.37984455823898317],
[0.38999999999999996 , 0.3787700280547142],
[0.39999999999999997 , 0.37855020314455035],
[0.41 , 0.3784992128610611],
[0.42 , 0.38090925812721255],
[0.43 , 0.38042167127132415],
[0.44 , 0.3819379895925522],
[0.45 , 0.3811051920056343],
[0.46 , 0.38223451375961304],
[0.47000000000000003 , 0.3816427975893021],
[0.48000000000000004 , 0.38095789700746535],
[0.49000000000000005 , 0.3802356541156769],
[0.5 , 0.38000407069921494],
[0.51 , 0.3806063771247864],
[0.52 , 0.37932794988155366],
[0.53 , 0.37881794571876526],
[0.54 , 0.37856238186359403],
[0.55 , 0.38265479207038877],
[0.56 , 0.3823509380221367],
[0.5700000000000001 , 0.3815410390496254],
[0.5800000000000001 , 0.3806999459862709],
[0.5900000000000001 , 0.3803206950426102],
[0.6000000000000001 , 0.37605037093162536],
[0.6100000000000001 , 0.37445745766162875],
[0.6200000000000001 , 0.3729034423828125],
[0.6300000000000001 , 0.3723421633243561],
[0.6399999999999999 , 0.3712897390127182],
[0.6499999999999999 , 0.3727384179830551],
[0.6599999999999999 , 0.371376471221447],
[0.6699999999999999 , 0.3702512443065643],
[0.6799999999999999 , 0.37035204470157623],
[0.69 , 0.36983475387096404],
[0.7 , 0.36881791353225707],
[0.71 , 0.3677432328462601],
[0.72 , 0.3663744658231735],
[0.73 , 0.35659249424934386],
[0.74 , 0.3559621304273605],
[0.75 , 0.3550954073667526],
[0.76 , 0.35465270578861235],
[0.77 , 0.35378554165363313],
[0.78 , 0.3534829497337341],
[0.79 , 0.3525427460670471],
[0.8 , 0.35048618018627165],
[0.81 , 0.3498073607683182],
[0.8200000000000001 , 0.34982924461364745],
[0.8300000000000001 , 0.34937061071395875],
[0.8400000000000001 , 0.34870922565460205],
[0.8500000000000001 , 0.34630596041679385],
[0.8600000000000001 , 0.345706707239151],
[0.8700000000000001 , 0.3438807040452957],
[0.8800000000000001 , 0.3423695951700211],
[0.8900000000000001 , 0.34068810343742373],
[0.9000000000000001 , 0.34016616344451905],
[0.9100000000000001 , 0.3393487691879272],
[0.9200000000000002 , 0.3396765023469925],
[0.9300000000000002 , 0.3373309522867203],
[0.9400000000000002 , 0.33873018622398376],
[0.9500000000000002 , 0.33816421031951904],
[0.96 , 0.3374047875404358],
[0.97 , 0.3369713068008423],
[0.98 , 0.3366970121860504],
[0.99 , 0.33436556756496427],
[1.0 , 0.3338984280824661],
[1.01 , 0.3334125250577927],
[1.02 , 0.33280529379844664],
[1.03 , 0.3321682423353195],
[1.04 , 0.3317057877779007],
[1.05 , 0.33152993619441984],
[1.06 , 0.33202681243419646],
[1.07 , 0.3316275984048843],
[1.08 , 0.3315922528505325],
[1.09 , 0.3314277172088623],
[1.1 , 0.33114551901817324],
[1.11 , 0.3306156486272812],
[1.12 , 0.3302706599235535],
[1.1300000000000001 , 0.33003646433353423],
[1.1400000000000001 , 0.3299188524484634],
[1.1500000000000001 , 0.3289624363183975],
[1.1600000000000001 , 0.3286141246557236],
[1.1700000000000002 , 0.32823376059532167],
[1.1800000000000002 , 0.32846716046333313],
[1.1900000000000002 , 0.32816471755504606],
[1.2 , 0.32775743007659913]]


# rope4
grid_2 = [[-0.2 , 0.27952564507722855],
[-0.19 , 0.2670821279287338],
[-0.18000000000000002 , 0.2572040021419525],
[-0.17 , 0.24481020569801332],
[-0.16 , 0.2392211750149727],
[-0.15000000000000002 , 0.23661888688802718],
[-0.14 , 0.23529136627912522],
[-0.13 , 0.23187325745821],
[-0.12000000000000001 , 0.22843065112829208],
[-0.11000000000000001 , 0.22580508440732955],
[-0.1 , 0.223937463760376],
[-0.09000000000000001 , 0.22263021171092987],
[-0.08000000000000002 , 0.22089551985263825],
[-0.07 , 0.21987367272377015],
[-0.06 , 0.2191641613841057],
[-0.05000000000000002 , 0.22072239071130753],
[-0.04000000000000001 , 0.22386125475168228],
[-0.03 , 0.22665368765592575],
[-0.020000000000000018 , 0.22912635207176207],
[-0.010000000000000009 , 0.23176472187042235],
[0.0 , 0.23564821779727935],
[0.009999999999999981 , 0.24131702035665512],
[0.01999999999999999 , 0.247100430727005],
[0.03 , 0.2504479974508286],
[0.03999999999999998 , 0.2543729290366173],
[0.04999999999999999 , 0.2613707795739174],
[0.06 , 0.26539716124534607],
[0.07 , 0.27164978384971616],
[0.08000000000000002 , 0.27449600398540497],
[0.08999999999999997 , 0.2712179958820343],
[0.09999999999999998 , 0.27148728966712954],
[0.10999999999999999 , 0.27094672322273256],
[0.12 , 0.27193932980298996],
[0.13 , 0.27261740565299986],
[0.14 , 0.27224796265363693],
[0.15000000000000002 , 0.2746424928307533],
[0.15999999999999998 , 0.2738574266433716],
[0.16999999999999998 , 0.2741402879357338],
[0.18 , 0.27508513927459716],
[0.19 , 0.27470198422670367],
[0.2 , 0.2739107012748718],
[0.21000000000000002 , 0.27536068558692933],
[0.21999999999999997 , 0.2759670063853264],
[0.22999999999999998 , 0.2756900697946548],
[0.24 , 0.27643489837646484],
[0.25 , 0.2757153481245041],
[0.26 , 0.2743495315313339],
[0.27 , 0.27358817011117936],
[0.27999999999999997 , 0.2731462851166725],
[0.29 , 0.27325296849012376],
[0.3 , 0.2740626633167267],
[0.31 , 0.27405432760715487],
[0.32 , 0.2745350480079651],
[0.33 , 0.27512937784194946],
[0.34 , 0.2746589884161949],
[0.35000000000000003 , 0.27547120302915573],
[0.36000000000000004 , 0.2750674605369568],
[0.37000000000000005 , 0.2762838304042816],
[0.37999999999999995 , 0.277354371547699],
[0.38999999999999996 , 0.27972806990146637],
[0.39999999999999997 , 0.2793955266475677],
[0.41 , 0.27893615812063216],
[0.42 , 0.2782493308186531],
[0.43 , 0.2785884439945221],
[0.44 , 0.2785391092300415],
[0.45 , 0.27841206789016726],
[0.46 , 0.27715546935796737],
[0.47000000000000003 , 0.27386576533317564],
[0.48000000000000004 , 0.27545899003744123],
[0.49000000000000005 , 0.27547024190425873],
[0.5 , 0.2773467719554901],
[0.51 , 0.27841738909482955],
[0.52 , 0.2795787587761879],
[0.53 , 0.2803734004497528],
[0.54 , 0.2809182986617088],
[0.55 , 0.2817441880702972],
[0.56 , 0.282423734664917],
[0.5700000000000001 , 0.2830744877457619],
[0.5800000000000001 , 0.28350226730108263],
[0.5900000000000001 , 0.283990840613842],
[0.6000000000000001 , 0.2854789301753044],
[0.6100000000000001 , 0.285434627532959],
[0.6200000000000001 , 0.28812567293643954],
[0.6300000000000001 , 0.2894004821777344],
[0.6399999999999999 , 0.2909176930785179],
[0.6499999999999999 , 0.29239232987165453],
[0.6599999999999999 , 0.29342403411865237],
[0.6699999999999999 , 0.29500463604927063],
[0.6799999999999999 , 0.29667621552944184],
[0.69 , 0.29648625999689104],
[0.7 , 0.2980348333716393],
[0.71 , 0.2994076877832413],
[0.72 , 0.30085315406322477],
[0.73 , 0.30168340504169466],
[0.74 , 0.3027073085308075],
[0.75 , 0.30334137082099916],
[0.76 , 0.3039014399051666],
[0.77 , 0.3051035970449448],
[0.78 , 0.3069243490695953],
[0.79 , 0.30816348642110825],
[0.8 , 0.3094020068645477],
[0.81 , 0.3111497849225998],
[0.8200000000000001 , 0.3126880079507828],
[0.8300000000000001 , 0.3141034960746765],
[0.8400000000000001 , 0.31511632800102235],
[0.8500000000000001 , 0.3157507568597794],
[0.8600000000000001 , 0.3170471340417862],
[0.8700000000000001 , 0.31800236403942106],
[0.8800000000000001 , 0.3189785599708557],
[0.8900000000000001 , 0.31917887926101685],
[0.9000000000000001 , 0.32024581283330916],
[0.9100000000000001 , 0.322081258893013],
[0.9200000000000002 , 0.3233725160360336],
[0.9300000000000002 , 0.32397802770137785],
[0.9400000000000002 , 0.3245620667934418],
[0.9500000000000002 , 0.32528301477432253],
[0.96 , 0.3255529284477234],
[0.97 , 0.3256619170308113],
[0.98 , 0.32798242568969727],
[0.99 , 0.32872663140296937],
[1.0 , 0.3299064576625824],
[1.01 , 0.3303358256816864],
[1.02 , 0.33087963461875913],
[1.03 , 0.33244140446186066],
[1.04 , 0.33339028507471086],
[1.05 , 0.3337589606642723],
[1.06 , 0.33418992906808853],
[1.07 , 0.326300773024559],
[1.08 , 0.32669050991535187],
[1.09 , 0.32738391011953355],
[1.1 , 0.32726308405399324],
[1.11 , 0.32771972715854647],
[1.12 , 0.32698045670986176],
[1.1300000000000001 , 0.32738766372203826],
[1.1400000000000001 , 0.327745196223259],
[1.1500000000000001 , 0.32794261574745176],
[1.1600000000000001 , 0.3282759845256805],
[1.1700000000000002 , 0.32859562784433366],
[1.1800000000000002 , 0.32890833616256715],
[1.1900000000000002 , 0.32911629378795626],
[1.2 , 0.3301952093839645]]


# rope6
grid_3 = [[ -0.2 , 0.4242639809846878 ],
[ -0.19 , 0.41206927299499513 ],
[ -0.18000000000000002 , 0.40180855989456177 ],
[ -0.17 , 0.3924367815256119 ],
[ -0.16 , 0.3842522829771042 ],
[ -0.15000000000000002 , 0.3773549944162369 ],
[ -0.14 , 0.37396700084209444 ],
[ -0.13 , 0.3706867516040802 ],
[ -0.12000000000000001 , 0.36736817061901095 ],
[ -0.11000000000000001 , 0.36258561313152315 ],
[ -0.1 , 0.359199595451355 ],
[ -0.09000000000000001 , 0.35545734167098997 ],
[ -0.08000000000000002 , 0.3498684674501419 ],
[ -0.07 , 0.34483861923217773 ],
[ -0.06 , 0.3393113732337952 ],
[ -0.05000000000000002 , 0.3354510933160782 ],
[ -0.04000000000000001 , 0.330604213476181 ],
[ -0.03 , 0.3244668781757355 ],
[ -0.020000000000000018 , 0.32146872878074645 ],
[ -0.010000000000000009 , 0.3186345279216766 ],
[ 0.0 , 0.3173598349094391 ],
[ 0.009999999999999981 , 0.31322788298130033 ],
[ 0.01999999999999999 , 0.30937533378601073 ],
[ 0.03 , 0.3135071277618408 ],
[ 0.03999999999999998 , 0.3115680679678917 ],
[ 0.04999999999999999 , 0.3108458638191223 ],
[ 0.06 , 0.31426385790109634 ],
[ 0.07 , 0.3132911682128906 ],
[ 0.08000000000000002 , 0.31219004690647123 ],
[ 0.08999999999999997 , 0.3133957877755165 ],
[ 0.09999999999999998 , 0.31252888441085813 ],
[ 0.10999999999999999 , 0.3122585296630859 ],
[ 0.12 , 0.3122511312365532 ],
[ 0.13 , 0.3121890529990196 ],
[ 0.14 , 0.3107816711068153 ],
[ 0.15000000000000002 , 0.3101915493607521 ],
[ 0.15999999999999998 , 0.3092351585626602 ],
[ 0.16999999999999998 , 0.3083635061979294 ],
[ 0.18 , 0.3103250741958618 ],
[ 0.19 , 0.31282104551792145 ],
[ 0.2 , 0.3123045593500137 ],
[ 0.21000000000000002 , 0.3115484267473221 ],
[ 0.21999999999999997 , 0.31043931692838667 ],
[ 0.22999999999999998 , 0.31011677384376524 ],
[ 0.24 , 0.3093527689576149 ],
[ 0.25 , 0.3129646867513657 ],
[ 0.26 , 0.308894607424736 ],
[ 0.27 , 0.3099880412220955 ],
[ 0.27999999999999997 , 0.30973690152168276 ],
[ 0.29 , 0.3089414402842522 ],
[ 0.3 , 0.3084318697452545 ],
[ 0.31 , 0.30841887593269346 ],
[ 0.32 , 0.30751200020313263 ],
[ 0.33 , 0.3070658817887306 ],
[ 0.34 , 0.3068047195672989 ],
[ 0.35000000000000003 , 0.3079228028655052 ],
[ 0.36000000000000004 , 0.30847464203834535 ],
[ 0.37000000000000005 , 0.30759344846010206 ],
[ 0.37999999999999995 , 0.30694352835416794 ],
[ 0.38999999999999996 , 0.30452119559049606 ],
[ 0.39999999999999997 , 0.30447437018156054 ],
[ 0.41 , 0.30425128936767576 ],
[ 0.42 , 0.3024003908038139 ],
[ 0.43 , 0.3012110710144043 ],
[ 0.44 , 0.3018858700990677 ],
[ 0.45 , 0.30176166594028475 ],
[ 0.46 , 0.3010073557496071 ],
[ 0.47000000000000003 , 0.3006511673331261 ],
[ 0.48000000000000004 , 0.3008221507072449 ],
[ 0.49000000000000005 , 0.3012753650546074 ],
[ 0.5 , 0.3008522540330887 ],
[ 0.51 , 0.3006648629903793 ],
[ 0.52 , 0.3005812793970108 ],
[ 0.53 , 0.30077425986528394 ],
[ 0.54 , 0.30015299171209336 ],
[ 0.55 , 0.29918563216924665 ],
[ 0.56 , 0.2994835197925568 ],
[ 0.5700000000000001 , 0.29946390986442567 ],
[ 0.5800000000000001 , 0.2991670176386833 ],
[ 0.5900000000000001 , 0.29901503920555117 ],
[ 0.6000000000000001 , 0.29923500269651415 ],
[ 0.6100000000000001 , 0.29943880140781404 ],
[ 0.6200000000000001 , 0.29918456077575684 ],
[ 0.6300000000000001 , 0.299215167760849 ],
[ 0.6399999999999999 , 0.2996911848187447 ],
[ 0.6499999999999999 , 0.30000014454126356 ],
[ 0.6599999999999999 , 0.3020377367734909 ],
[ 0.6699999999999999 , 0.29987499713897703 ],
[ 0.6799999999999999 , 0.29990154355764387 ],
[ 0.69 , 0.3000610753893852 ],
[ 0.7 , 0.2994943633675575 ],
[ 0.71 , 0.30702288150787355 ],
[ 0.72 , 0.30778121650218965 ],
[ 0.73 , 0.3087842479348183 ],
[ 0.74 , 0.3096693530678749 ],
[ 0.75 , 0.310187840461731 ],
[ 0.76 , 0.3120598465204239 ],
[ 0.77 , 0.3131591647863388 ],
[ 0.78 , 0.3145402133464813 ],
[ 0.79 , 0.3165098875761032 ],
[ 0.8 , 0.3193113446235657 ],
[ 0.81 , 0.3184545010328293 ],
[ 0.8200000000000001 , 0.31971350461244585 ],
[ 0.8300000000000001 , 0.3187043309211731 ],
[ 0.8400000000000001 , 0.31901451498270034 ],
[ 0.8500000000000001 , 0.3201531767845154 ],
[ 0.8600000000000001 , 0.3228225752711296 ],
[ 0.8700000000000001 , 0.3244200125336647 ],
[ 0.8800000000000001 , 0.323682975769043 ],
[ 0.8900000000000001 , 0.3247440308332443 ],
[ 0.9000000000000001 , 0.325693441927433 ],
[ 0.9100000000000001 , 0.32627394497394563 ],
[ 0.9200000000000002 , 0.3235334888100624 ],
[ 0.9300000000000002 , 0.3250111401081085 ],
[ 0.9400000000000002 , 0.32451639175415037 ],
[ 0.9500000000000002 , 0.3251820385456085 ],
[ 0.96 , 0.3261065900325775 ],
[ 0.97 , 0.3267944321036339 ],
[ 0.98 , 0.331566821038723 ],
[ 0.99 , 0.3334443509578705 ],
[ 1.0 , 0.3338744729757309 ],
[ 1.01 , 0.33472113609313964 ],
[ 1.02 , 0.3348801761865616 ],
[ 1.03 , 0.3414071649312973 ],
[ 1.04 , 0.34140886962413786 ],
[ 1.05 , 0.3417420446872711 ],
[ 1.06 , 0.34216074347496034 ],
[ 1.07 , 0.344486677646637 ],
[ 1.08 , 0.34425672590732576 ],
[ 1.09 , 0.34473696947097776 ],
[ 1.1 , 0.3461481317877769 ],
[ 1.11 , 0.3473769977688789 ],
[ 1.12 , 0.3482008397579193 ],
[ 1.1300000000000001 , 0.348016095161438 ],
[ 1.1400000000000001 , 0.34773446172475814 ],
[ 1.1500000000000001 , 0.3475434496998787 ],
[ 1.1600000000000001 , 0.34840141534805297 ],
[ 1.1700000000000002 , 0.34976787865161896 ],
[ 1.1800000000000002 , 0.3500985324382782 ],
[ 1.1900000000000002 , 0.34999600052833557 ],
[ 1.2 , 0.3502128511667252 ]]


fig = plt.figure(figsize=(1.6, 2.5))
ax = plt.subplot(111)


# rope1
# save_path = 'fig1-3-1.pdf'
# xmin = 0.29
# xmax = 0.56
# ax.set_xlim([xmin, xmax])
# xticks_major = [0.3, 0.55]
# xticks_minor = np.arange(0.3, 0.6, 0.05)
# l1_grid = grid_1


# rope4
save_path = 'fig_0130.pdf'
xmin = 0.19
xmax = 0.41
ax.set_xlim([xmin, xmax])
xticks_major = [0.2, 0.4]
xticks_minor = np.arange(0.2, 0.4, 0.05)
l1_grid = grid_2


# rope6
# save_path = 'fig1-3-3.pdf'
# xmin = 0.29
# xmax = 0.46
# ax.set_xlim([xmin, xmax])
# xticks_major = [0.3, 0.45]
# xticks_minor = np.arange(0.3, 0.45, 0.05)
# l1_grid = grid_3


l1_grid = np.array(l1_grid)
l1_x = l1_grid[:, 1][::2]
l1_y = l1_grid[:, 0][::2]

l1_min = np.argmin(l1_x)
print(l1_y[l1_min])

ymin = -0.25
ymax = 1.25
ax.set_ylim([ymin, ymax])
yticks_major = []
yticks_minor = np.arange(-0.2, 1.2, 0.2)

cmap = plt.cm.get_cmap('coolwarm_r')
def get_colors(x):
    return cmap((x - np.min(x)) / (np.max(x) - np.min(x)))

ax.imshow([[-1,1],[-1,1]], cmap=cmap, interpolation='bicubic', extent=plt.xlim() + plt.ylim(), aspect='auto', alpha=0.25) 

p1 = LineCollection(
    [[[l1_x[i], l1_y[i]], [l1_x[i+1], l1_y[i+1]]] for i in range(len(l1_x)-1)], 
    colors='black', #get_colors(l1_x[:-1]), 
    linewidths=1.5, cmap=cmap
)
ax.add_collection(p1)
fig.colorbar(p1, cmap=cmap)

ax.axhline(y=l1_y[l1_min], linestyle='--', linewidth=1.5, color=palette[3])

ax.xaxis.set_label_coords(0.5, -0.1)
ax.yaxis.set_label_coords(-0.1, 0.5)
ax.set_ylabel('', fontsize=12)
ax.set_xlabel('Mean CD', fontsize=12)

ax.grid(which='minor', linestyle='--', alpha=0.3)
ax.grid(which='major', linestyle='--', alpha=0.3)
ax.tick_params(axis='both', which='major', labelsize=10)
ax.tick_params(axis='both', which='minor', labelsize=10)

ax.set_xticks(xticks_major)
ax.set_xticks(xticks_minor, minor=True)
ax.set_yticks(yticks_major)
ax.set_yticks(yticks_minor, minor=True)
# ax.legend(fontsize=8, bbox_to_anchor=(0.34, 0.41), frameon=False)
# ax.legend(loc='upper center', bbox_to_anchor=(0.5, 1), ncol=4, fontsize=8, frameon=False)

ax.axhspan(-0.25, 0, alpha=0.15, color=palette[4])
ax.axhspan(1, 1.25, alpha=0.15, color=palette[4])

fig.tight_layout()

plt.savefig(save_path, format='pdf', bbox_inches='tight')
plt.show()




